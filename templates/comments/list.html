{% load markup stringutils gravatar %}

<div id="comments" class="comment_list">
  <a name="comments"></a>
  <h2 class="title">Comments</h2>
  {% for comment in comment_list %}
    {% if comment.is_public %}
    <div class="comment">
      <p class="comment-remove right">
        {% if comment.user == user or request.user.is_superuser %}
        <a class="remove" href="{% url comments-delete comment.id %}">Remove</a>
        {% endif %}
      </p>
      <h5 class="name">
        <a name="c{{ comment.id }}"
           href="{{ comment.get_absolute_url }}"
           title="Permalink to {{ comment.user.get_full_name }}'s comment"
           class="count avatar"
           style="background-image: url({% gravatar_for_email comment.user.email 48 %})">{{ forloop.counter }}</a>
        <a href="{{ comment.user.get_absolute_url }}" title="View {{ comment.user.get_full_name }}'s profile">
          {{ comment.user.get_full_name }} <small>{{ comment.user.get_absolute_url }}</small>
        </a>
      </h5>
      {{ comment.comment|urlizetrunc:"60"|markdown }}
      <p class="date">Posted at {{ comment.submit_date|date:"P" }} on {{ comment.submit_date|date:"F j, Y" }}</p>
    </div>
    {% endif %}
  {% endfor %}
</div>
